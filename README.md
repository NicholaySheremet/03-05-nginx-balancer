# Доклад №3: "Серверная часть сетевого приложения"

### Пример №2. Пример настройки в nginx HTTPS и проксирования

##### Установка и запуск

1. Установить [Node.js](https://nodejs.org/en/) и [Git](https://git-scm.com/downloads) (по желанию)
2. Клонировать или загрузить проект в виде архива
3. Установить [nginx](https://nginx.org/ru/download.html)

В консоли/терминале:
``` bash
# Перейти в папку, в которую планируется клонирование проекта, например:
$ cd /Projects
# Клонировать проект из репозитория
$ git clone https://github.com/econri/03-05-nginx-balancer.git
```

3. Запустить первый экземпляр

В консоли/терминале:

``` bash
# Перейти в папку проекта
$ cd 03-05-nginx-balancer
# Запустить
$ npm start
```

Web-приложение будет запущено по адресу http://localhost:3000

4. Скопировать папку проекта, изменить значение константы `PORT` `server.js` с `3000` на `3001`

5. Запустить второй экземпляр.

В консоли/терминале:

``` bash
# Перейти в папку проекта
$ cd 03-05-nginx-balancer-copy
# Запустить
$ npm start
```

Web-приложение будет запущено по адресу http://localhost:3001

6. Настройка nginx

Для настройки nginx  будет достаточно заменить содержимое файла `default`, который находится в папке `sites-enabled` папки установки nginx, на содержимое файла `nginx-default` данного проекта. В ОС Ubuntu путь к файлу `default` выглядит следующим образом: `/etc/nginx/sites-enabled/default`.

осле сохранения изменений в настройках нужно перезапустить сервер nginx.

В консоли/терминале:

``` bash
$ sudo service nginx restart
```

При обращении в браузере по адресу `localhost` nginx, в соответствии с настройками, будет равномерно распределять нагрузку между двумя копиями web-приложения (http://localhost:3000, http://localhost:3001). 

##### Ссылки:

1. [nginx](https://nginx.org/ru/download.html)

##### Файл конфигурации nginx:

``` nginx
# Настройка балансировки
upstream backend {
	server  localhost:3000;
  server  localhost:3001;
}
server {
  # Настройка проксирования
  location / {
    # Перенаправление запросов
    proxy_pass http://backend;
  }
}
```